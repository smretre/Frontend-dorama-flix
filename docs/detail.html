<body style="background:#0B0B0F;color:white;font-family:Arial;padding:16px">

<div id="content"></div>

<script>
const id = new URLSearchParams(location.search).get("id");

fetch("https://dorama-repository-fp.onrender.com/api/item/" + id)
.then(r=>r.json())
.then(d => {
 document.getElementById("content").innerHTML = `
   <img src="${d.cover}" style="width:100%;border-radius:14px">
   <h2>${d.title}</h2>
   <p>${d.description}</p>
   <button onclick="buy('${d._id}')" style="
     background:#7A3CFF;
     padding:12px;
     border-radius:10px;
     border:none;
     color:white;
     width:100%;
     font-weight:bold;">
     ðŸŽ¬ Assistir Agora â€” R$${d.price}
   </button>
 `;
});

function buy(id){
 fetch("https://dorama-repository-fp.onrender.com/api/create_payment",{
   method:"POST",
   headers:{'Content-Type':'application/json'},
   body: JSON.stringify({
     item_id:id,
     user: Telegram.WebApp.initDataUnsafe.user.id
   })
 })
 .then(r=>r.json())
 .then(data => window.location.href = data.url);
}
</script>
</body>
